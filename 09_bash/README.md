# Пишем скрипт

### Описание/Пошаговая инструкция выполнения домашнего задания:

Написать скрипт для CRON, который раз в час будет формировать письмо и отправлять на заданную почту.
Необходимая информация в письме:

  *  Список IP адресов (с наибольшим кол-вом запросов) с указанием кол-ва запросов c момента последнего запуска скрипта;
  *  Список запрашиваемых URL (с наибольшим кол-вом запросов) с указанием кол-ва запросов c момента последнего запуска скрипта;
  *  Ошибки веб-сервера/приложения c момента последнего запуска;
  *  Список всех кодов HTTP ответа с указанием их кол-ва с момента последнего запуска скрипта.
  *  Скрипт должен предотвращать одновременный запуск нескольких копий, до его завершения.
  *  В письме должен быть прописан обрабатываемый временной диапазон.

---

### решение
[Скрипт](mailgen.sh)

### как проверить

``` sh 
# Установим пакет faketime
 sudo apt install  faketime    
# Создадим каталог для локфайла  и дадим права
 sudo mkdir /var/run/monitor
 sudo chown $USER   /var/run/monitor  
```
тестим с подменной даты
```sh
faketime '2019-08-14 08:25:30' bash mailgen.sh
```
---
[Команда awk – примеры использования в Linux и Unix](https://habr.com/ru/company/ruvds/blog/665084/)

