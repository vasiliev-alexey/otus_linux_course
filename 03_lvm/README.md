# Работа с LVM

## Описание/Пошаговая инструкция выполнения домашнего задания:

на имеющемся образе (centos/7 1804.2)
https://gitlab.com/otus_linux/stands-03-lvm
/dev/mapper/VolGroup00-LogVol00 38G 738M 37G 2% /

 1.   уменьшить том под / до 8G
 2.   выделить том под /home
 3.   выделить том под /var (/var - сделать в mirror)
 4.   для /home - сделать том для снэпшотов
 5.   прописать монтирование в fstab (попробовать с разными опциями и разными файловыми системами на выбор)
 6. Работа со снапшотами:

    *   сгенерировать файлы в /home/
    *   снять снэпшот
    *   удалить часть файлов
    *   восстановиться со снэпшота
       (залоггировать работу можно утилитой script, скриншотами и т.п.)

* На нашей куче дисков попробовать поставить btrfs/zfs:

 *   с кешем и снэпшотами
 *   разметить здесь каталог /opt

---

###  1. уменьшить том под / до 8G  


<details><summary>Подготовка к переносу</summary>
<p>


Логинимся в вируталку
```sh
vagrant ssh
```
Подгатавливаем   fs к перносу
```sh
sudo bash tasks/task_1_1.sh
```

</p>
</details>


<details><summary>Перенос </summary>
<p>


Логинимся в вируталку
```sh
vagrant ssh
```
Переносим fs с уменьшением размера
```sh
sudo bash tasks/task_1_2.sh
```

</p>
</details>
<details><summary>Убираем более не нужные данные</summary>
<p>


Логинимся в вируталку
```sh
vagrant ssh
```
прибираемся на хосте
```sh
sudo bash tasks/task_1_3.sh
```

</p>
</details>


###  2. выделить том под /home

<details><summary>выделить том под /home</summary>
<p>


Логинимся в вируталку
```sh
vagrant ssh
```
Подгатавливаем   fs к перносу
```sh
sudo bash tasks/task_2.sh
```

</p>
</details>


###  3. выделить том под /var (/var - сделать в mirror)

<details><summary>выделить том под /var</summary>
<p>


Логинимся в вируталку
```sh
vagrant ssh
```
Подгатавливаем   fs к перносу
```sh
sudo bash tasks/task_3.sh
```

</p>
</details>

###  4-6. для /home - сделать том для снэпшотов + работа со снэпшотами

<details><summary>для /home - сделать том для снэпшотов + работа со снэпшотами</summary>
<p>


Логинимся в вируталку
```sh
vagrant ssh
```
Подгатавливаем   fs к перносу
```sh
sudo bash tasks/task_4.sh
```

</p>
</details>

### 5  прописать монтирование в fstab 
использовалось в  решнии этапа 1